(()=>{"use strict";function e(e){const{directives:t,element:n,context:s}=e,{model:o,ref:i}=t;if(o){const[e,t]=o.get();n.value=e(),n.addEventListener("input",(e=>{t(e.target.value),s.detectChanges()}))}i&&i.set(n)}let t;function n(e){for(const[t,n]of Object.entries(e))this.props[t]=n;this.hooks.run(t.onPropsChange,[this.props]),this.isConnected&&this.detectChanges()}var s;(s=t||(t={})).afterInit="afterInit",s.onDestroy="onDestroy",s.onViewChange="onViewChange",s.onChangeDetection="onChangeDetection",s.onPropsChange="onPropsChange";class o{hooks={afterInit:[],onDestroy:[],onViewChange:[],onChangeDetection:[],onPropsChange:[]};set(e,t){this.hooks[e].push(t)}run(e,t=[]){this.hooks[e]=this.hooks[e].filter((e=>e.isActive())),this.hooks[e].forEach((e=>e.hook(...t)))}clear(e){this.hooks[e]=[]}}function i(e){customElements.define(e.selector,e)}function r(s,r){const c=s.superClass||HTMLElement;return class extends c{static selector=r;fn=s;state={};stateIndex=0;directives={view:e,...s.directives};pipes=s.pipes||{};hooks=new o;props={};setProps=n.bind(this);isCDRunning=!1;detectChanges=()=>function(e){if(e.isCDRunning)return;e.isCDRunning=!0;let n=function(e){let t=!1;return[...e.conditionWatchers,...e.watchers].forEach((e=>{e.isUpdated()&&e.isConnected()&&(t=!0,e.update(e.val))})),e.conditionWatchers=e.conditionWatchers.filter((e=>e.isConnected())),e.watchers=e.watchers.filter((e=>e.isConnected())),t}(e);e.hooks.run(t.onChangeDetection),n&&e.hooks.run(t.onViewChange),e.isCDRunning=!1}(this);watchers=[];conditionWatchers=[];connectedCallback(){this.fn.childrenDefined||(this.fn.children||[]).forEach((e=>i(e))),this.fn.childrenDefined=!0;const e=this.fn(this.props,this);if(this.appendChild(e),this.fn.styles){const e=this.fn.styles;this.fn.styles=null;const t=document.createElement("style");t.textContent=e,document.getElementsByTagName("head")[0].appendChild(t)}Object.keys(this.props).length>0&&this.hooks.run(t.onPropsChange,[this.props]),this.hooks.run(t.afterInit),this.hooks.clear(t.afterInit)}disconnectedCallback(){this.hooks.run(t.onDestroy)}}}function c(e,t={},n=[]){const s=document.createElement(e);for(const[e,n]of Object.entries(t))s.setAttribute(e,n);return s.append(...n),s}function a(e){return document.createTextNode(e)}function h(e,t,n){const s={val:{},isConnected:()=>t.isConnected,isUpdated:()=>{let e=!1;for(const[t,o]of Object.entries(n)){const n=o();s.val[t]!==n&&(e=!0),s.val[t]=n}return e},update:e=>{for(const[n,s]of Object.entries(e))t.setAttribute(n,s)}};for(const[e,o]of Object.entries(n)){const n=o();s.val[e]=n,t.setAttribute(e,n)}return e.watchers.push(s),t}function d(e,t){const n=t(),s=document.createTextNode(n),o={val:n,isConnected:()=>s.isConnected,isUpdated:()=>{const e=t();return o.val!==e&&(o.val=e,!0)},update:e=>s.textContent=e};return e.watchers.push(o),s}function l(e,t,n,s,o){const i=customElements.get(e);if(!i)return void console.error(`The component ${e} is not defined.`);const r=new i;if(Object.keys(o).length>0){const e={val:{},isConnected:()=>r.isConnected,isUpdated:()=>{let t=!1;for(const[n,s]of Object.entries(o)){const o=s();e.val[n]!==o&&(t=!0),e.val[n]=o}return t},update:e=>{r.setProps(e)}};e.isUpdated(),e.update(e.val),s.watchers&&Array.isArray(s.watchers)&&s.watchers.push(e)}for(const[e,n]of Object.entries(t))r.setAttribute(e,n);return r.append(...n),r}class u{constructor(){if(u.instance)return u.instance;window.__REDUX_DEVTOOLS_EXTENSION__&&(this.devTool=window.__REDUX_DEVTOOLS_EXTENSION__.connect()),u.instance=this}subscribe(e){this.devTool&&this.devTool.subscribe(e)}init(e){this.devTool&&this.devTool.init(e)}send(e,t){this.devTool&&this.devTool.send(e,t)}}let f={},p=[];const C=new u;function v(e,t){return e.selector=t,e}C.subscribe((e=>{if("DISPATCH"===e.type&&e.state){const t=JSON.parse(e.state);for(const e in t)f[e]=t[e];p=p.filter((e=>e.isConnected())),p.forEach((e=>e.changeDetection()))}})),C.init(f),v((function(e){return e.toLowerCase()}),"lowercase"),v((function(e,t){return e.toUpperCase()}),"uppercase");i(r((function(){return c("h1",{"mn-el-1":""},[a("Child")])}),"app-child")),i(r((function(){const e=this;return c("div",{"mn-el-2":""},[a("\n        "),h(e,c("h1",{"mn-el-2":""},[a("Hello World!")]),{id:()=>100}),a("\n        "),d(e,(()=>"dev")),a(" xx\n        "),l("app-child",{"mn-el-2":""},[],e,{}),a("\n    ")])}),"app-root"))})();
//# sourceMappingURL=index.js.map