{"version":3,"file":"index.js","mappings":"mBAEO,SAASA,EAAQC,GACpB,MAAM,WAAEC,EAAF,QAAcC,EAAd,QAAuBC,GAAYH,GACnC,MAAEI,EAAF,IAASC,GAAQJ,EAEvB,GAAIG,EAAO,CACP,MAAQE,EAAaC,GAAgBH,EAAMI,MAC1CN,EAA6BO,MAAQH,IACtCJ,EAAQQ,iBAAiB,SAAUC,IAC/BJ,EAAYI,EAAMC,OAAOH,OACzBN,EAAQU,eAAR,GAEP,CAEGR,GACAA,EAAIS,IAAIZ,EAEf,CClBM,IAAKa,ECSL,SAASC,EAASC,GACrB,IAAK,MAAOC,EAAKT,KAAUU,OAAOC,QAAQH,GACtCI,KAAKJ,MAAMC,GAAOT,EAEtBY,KAAKC,MAAMC,IAAIR,EAAAA,cAAwB,CAACM,KAAKJ,QACzCI,KAAKG,aACLH,KAAKR,eAEZ,C,IDjBWE,KAAAA,IAAAA,EAAAA,CAAAA,IAAAA,UAAAA,YAAAA,EAAAA,UAAAA,YAAAA,EAAAA,aAAAA,eAAAA,EAAAA,kBAAAA,oBAAAA,EAAAA,cAAAA,gBEIL,MAAMU,EACDH,MAA8C,CAClDI,UAAW,GACXC,UAAW,GACXC,aAAc,GACdC,kBAAmB,GACnBC,cAAe,IAGZhB,IAAII,EAAea,GACtBV,KAAKC,MAAMJ,GAAKc,KAAKD,EACxB,CAEMR,IAAIL,EAAee,EAAc,IACpCZ,KAAKC,MAAMJ,GAAOG,KAAKC,MAAMJ,GAAKgB,QAAOH,GAAQA,EAAKI,aACtDd,KAAKC,MAAMJ,GAAKkB,SAAQC,GAAQA,EAAKN,QAAQE,IAChD,CAEMK,MAAMpB,GACTG,KAAKC,MAAMJ,GAAO,EACrB,ECtBE,SAASqB,EAAgBC,GAC5BC,eAAeC,OAAOF,EAAUG,SAAUH,EAC7C,CCQM,SAASA,EAAUI,EAAsCD,GAE5D,MAAME,EAAaD,EAAkBC,YAAcC,YAEnD,OAAO,cAAcD,EAEK,gBAAGF,EAGjBI,GAAKH,EAMbI,MAAsB,CAAC,EACvBC,WAAqB,EAMrBhD,WAA4D,CACxDiD,KAAMnD,KACH6C,EAAkB3C,YAOzBkD,MAAQP,EAAkBO,OAAS,CAAC,EAMpC7B,MAAkB,IAAIG,EAMtBR,MAAsB,CAAC,EACvBD,SAAWA,EAASoC,KAAK/B,MAMlBgC,aAAuB,EAC9BxC,cAAgB,ICrDjB,SAAuBV,GAC1B,GAAIA,EAAQkD,YACR,OAEJlD,EAAQkD,aAAc,EAEtB,IAAIC,ECdD,SAA0BnD,GAC7B,IAAImD,GAAiB,EAYrB,MAXA,IAAInD,EAAQoD,qBAAsBpD,EAAQqD,UAAUpB,SAAQqB,IACpDA,EAAQC,aAAeD,EAAQjC,gBAC/B8B,GAAiB,EACjBG,EAAQE,OAAOF,EAAQG,KAC1B,IAILzD,EAAQoD,kBAAoBpD,EAAQoD,kBAAkBrB,QAAOuB,GAAWA,EAAQjC,gBAChFrB,EAAQqD,SAAWrD,EAAQqD,SAAStB,QAAOuB,GAAWA,EAAQjC,gBAEvD8B,CACV,CDAwBO,CAAiB1D,GAEtCA,EAAQmB,MAAMC,IAAIR,EAAAA,mBACduC,GACAnD,EAAQmB,MAAMC,IAAIR,EAAAA,cAGtBZ,EAAQkD,aAAc,CACzB,CDuC6BxC,CAAcQ,MACpCmC,SAAsB,GACtBD,kBAA+B,GAM/BO,oBAESzC,KAAK0B,GAAGgB,kBACR1C,KAAK0B,GAAGiB,UAAY,IAAI5B,SAAQ6B,GAAS1B,EAAgB0B,KAE9D5C,KAAK0B,GAAGgB,iBAAkB,EAE1B,MAAM7D,EAAUmB,KAAK0B,GAAG1B,KAAKJ,MAAOI,MAIpC,GAHAA,KAAK6C,YAAYhE,GAGbmB,KAAK0B,GAAGoB,OAAQ,CAChB,MAAMA,EAAS9C,KAAK0B,GAAGoB,OACvB9C,KAAK0B,GAAGoB,OAAS,KACjB,MAAMC,EAAUC,SAASC,cAAc,SACvCF,EAAQG,YAAcJ,EACtBE,SAASG,qBAAqB,QAAQ,GAAGN,YAAYE,EACxD,CAMGjD,OAAOsD,KAAKpD,KAAKJ,OAAOyD,OAAS,GACjCrD,KAAKC,MAAMC,IAAIR,EAAAA,cAAwB,CAACM,KAAKJ,QAIjDI,KAAKC,MAAMC,IAAIR,EAAAA,WACfM,KAAKC,MAAMgB,MAAMvB,EAAAA,UACpB,CAED4D,uBACItD,KAAKC,MAAMC,IAAIR,EAAAA,UAClB,EAGR,CG1GM,SAASuD,EAAcM,EAAaC,EAA2B,CAAC,EAAGb,EAAmC,IACzG,MAAM9D,EAAUmE,SAASC,cAAcM,GAEvC,IAAK,MAAO1D,EAAKT,KAAUU,OAAOC,QAAQyD,GACtC3E,EAAQ4E,aAAa5D,EAAKT,GAK9B,OAFAP,EAAQ6E,UAAUf,GAEX9D,CACV,CCZM,SAAS8E,EAAWC,GACvB,OAAOZ,SAASa,eAAeD,EAClC,CCEM,SAASE,EAAiBhF,EAA4BD,EAAsB2E,GAE/E,MAAMpB,EAAmB,CACrBG,IAAK,CAAC,EACNpC,YAAa,IAAMtB,EAAQsB,YAC3BkC,UAAW,KACP,IAAIA,GAAY,EAEhB,IAAK,MAAOxC,EAAKT,KAAUU,OAAOC,QAAQyD,GAAa,CACnD,MAAMO,EAAW3E,IACbgD,EAAQG,IAAI1C,KAASkE,IACrB1B,GAAY,GAEhBD,EAAQG,IAAI1C,GAAOkE,CACtB,CAED,OAAO1B,CAAP,EAEJC,OAAUyB,IACN,IAAK,MAAOlE,EAAKT,KAAUU,OAAOC,QAAQgE,GACtClF,EAAQ4E,aAAa5D,EAAKT,EAC7B,GAIT,IAAK,MAAOS,EAAKT,KAAUU,OAAOC,QAAQyD,GAAa,CACnD,MAAMQ,EAAe5E,IACrBgD,EAAQG,IAAI1C,GAAOmE,EACnBnF,EAAQ4E,aAAa5D,EAAKmE,EAC7B,CAGD,OADAlF,EAAQqD,SAASxB,KAAKyB,GACfvD,CACV,CClCM,SAASoF,EAAYnF,EAA4BoF,GACpD,MAAM3B,EAAM2B,IACNN,EAAOZ,SAASa,eAAetB,GAE/BH,EAAmB,CACrBG,MACApC,YAAa,IAAMyD,EAAKzD,YACxBkC,UAAW,KACP,MAAM0B,EAAWG,IACjB,OAAI9B,EAAQG,MAAQwB,IAChB3B,EAAQG,IAAMwB,GACP,EAEX,EAEJzB,OAASyB,GAAkBH,EAAKV,YAAca,GAKlD,OAFAjF,EAAQqD,SAASxB,KAAKyB,GAEfwB,CACV,CCpBM,SAASO,EACZZ,EACAC,EACAb,EACA7D,EACAc,GAEA,MAAMgD,EAAQxB,eAAejC,IAAIoE,GACjC,IAAKX,EAED,YADAwB,QAAQC,MAAO,iBAAgBd,qBAGnC,MAAM1E,EAAU,IAAI+D,EAEpB,GAAI9C,OAAOsD,KAAKxD,GAAOyD,OAAS,EAAG,CAI/B,MAAMjB,EAAmB,CACrBG,IAAK,CAAC,EACNpC,YAAa,IAAMtB,EAAQsB,YAC3BkC,UAAW,KACP,IAAIiC,GAAa,EACjB,IAAK,MAAOzE,EAAKT,KAAUU,OAAOC,QAAQH,GAAQ,CAC9C,MAAMmE,EAAW3E,IACbgD,EAAQG,IAAI1C,KAASkE,IACrBO,GAAa,GAEjBlC,EAAQG,IAAI1C,GAAOkE,CACtB,CACD,OAAOO,CAAP,EAEJhC,OAASyB,IACJlF,EAAyCc,SAASoE,EAAnD,GAGR3B,EAAQC,YACRD,EAAQE,OAAOF,EAAQG,KACnBzD,EAAQqD,UAAYoC,MAAMC,QAAQ1F,EAAQqD,WAC1CrD,EAAQqD,SAASxB,KAAKyB,EAE7B,CAGD,IAAK,MAAOvC,EAAKT,KAAUU,OAAOC,QAAQyD,GACtC3E,EAAQ4E,aAAa5D,EAAKT,GAG9B,OADAP,EAAQ6E,UAAUf,GACX9D,CACV,CCnDM,MAAM4F,EAKTC,cACI,GAAID,EAAQE,SACR,OAAOF,EAAQE,SAGdC,OAAeC,+BAChB7E,KAAK8E,QAAWF,OAAeC,6BAA6BE,WAGhEN,EAAQE,SAAW3E,IACtB,CAEDgF,UAAUC,GACFjF,KAAK8E,SACL9E,KAAK8E,QAAQE,UAAUC,EAE9B,CAEDC,KAAKvD,GACG3B,KAAK8E,SACL9E,KAAK8E,QAAQI,KAAKvD,EAEzB,CAEDwD,KAAKC,EAAgBzD,GACb3B,KAAK8E,SACL9E,KAAK8E,QAAQK,KAAKC,EAAQzD,EAEjC,EC3BL,IAAIA,EAAQ,CAAC,EACT0D,EAAsC,GAM1C,MAAMP,EAAU,IAAIL,ECbb,SAASa,EAAKC,EAAsBjE,GAEvC,OADAiE,EAAOjE,SAAWA,EACXiE,CACV,CDWDT,EAAQE,WAAWQ,IACf,GAAqB,aAAjBA,EAAQC,MAAuBD,EAAQ7D,MAAO,CAC9C,MAAM+D,EAAUC,KAAKC,MAAMJ,EAAQ7D,OAEnC,IAAK,MAAM9B,KAAO6F,EACd/D,EAAM9B,GAAO6F,EAAQ7F,GAuC7BwF,EAAmBA,EAAiBxE,QAAOG,GAAQA,EAAKb,gBACxDkF,EAAiBtE,SAAQC,GAAQA,EAAK6E,mBApCrC,KAELf,EAAQI,KAAKvD,GErBgB2D,GAJ7B,SAAmB1B,GACf,OAAOA,EAAKkC,aACf,GAE4C,aCAhBR,GAJ7B,SAAmB1B,EAAcjF,GAC7B,OAAOiF,EAAKmC,aACf,GAE4C,aCC7C7E,EAAgBC,GAJhB,WACI,OAAO,uBAAI,YACd,GAEgC,cCJjCD,EDeeC,GATf,WAAe,aAEX,OAAO,wBAAK,gBACR,2BAAY,oBAAZ,QAFK,MAEwB,gBAD1B,SEVA,QFYgB,mBACnB,sCAAuB,aAE9B,GAE6B,Y","sources":["webpack://@monster-js/test-app/../core/src/directives/view.directive.ts","webpack://@monster-js/test-app/../core/src/enums/hook-keys.enum.ts","webpack://@monster-js/test-app/../core/src/component/set-props.ts","webpack://@monster-js/test-app/../core/src/component/hooks.ts","webpack://@monster-js/test-app/../core/src/utils/define-component.ts","webpack://@monster-js/test-app/../core/src/component/component.ts","webpack://@monster-js/test-app/../core/src/component/detect-changes.ts","webpack://@monster-js/test-app/../core/src/component/evaluate-watchers.ts","webpack://@monster-js/test-app/../core/src/view-engine/create-element.ts","webpack://@monster-js/test-app/../core/src/view-engine/create-text.ts","webpack://@monster-js/test-app/../core/src/view-engine/attribute-binding.ts","webpack://@monster-js/test-app/../core/src/view-engine/text-binding.ts","webpack://@monster-js/test-app/../core/src/view-engine/render-child.ts","webpack://@monster-js/test-app/../core/src/utils/dev-tool.ts","webpack://@monster-js/test-app/../core/src/state/create-shared-state.ts","webpack://@monster-js/test-app/../core/src/pipes/pipe.ts","webpack://@monster-js/test-app/../core/src/pipes/lowercase.pipe.ts","webpack://@monster-js/test-app/../core/src/pipes/uppercase.pipe.ts","webpack://@monster-js/test-app/./src/app/app.tsx","webpack://@monster-js/test-app/./src/index.ts","webpack://@monster-js/test-app/./src/environments/environment.ts"],"sourcesContent":["import { DirectiveParam } from \"../interfaces/directive-param.interface\";\r\n\r\nexport function viewDir(params: DirectiveParam) {\r\n    const { directives, element, context } = params;\r\n    const { model, ref } = directives;\r\n\r\n    if (model) {\r\n        const [ modelGetter, modelSetter ] = model.get();\r\n        (element as HTMLInputElement).value = modelGetter();\r\n        element.addEventListener('input', (event: any) => {\r\n            modelSetter(event.target.value);\r\n            context.detectChanges();\r\n        });\r\n    }\r\n\r\n    if (ref) {\r\n        ref.set(element);\r\n    }\r\n}\r\n","export enum HookKeys {\r\n    afterInit = 'afterInit',\r\n    onDestroy = 'onDestroy',\r\n    onViewChange = 'onViewChange',\r\n    onChangeDetection = 'onChangeDetection',\r\n    onPropsChange = 'onPropsChange'\r\n}","import { HookKeys } from \"../enums/hook-keys.enum\";\r\nimport { CustomObject } from \"../interfaces/custom-object.interface\";\r\n\r\n/**\r\n * This function is used to set props from the parent component to child.\r\n * The `this` context is the child component\r\n * \r\n * @param props The properties that will be passed to the component from the parent\r\n */\r\nexport function setProps(props: CustomObject) {\r\n    for (const [key, value] of Object.entries(props)) {\r\n        this.props[key] = value;\r\n    }\r\n    this.hooks.run(HookKeys.onPropsChange, [this.props])\r\n    if (this.isConnected) {\r\n        this.detectChanges();\r\n    }\r\n}\r\n","import { HookKeys } from \"../enums/hook-keys.enum\";\r\nimport { HookItem } from \"../interfaces/hook-item.interface\";\r\nimport { Hooks } from \"../interfaces/hooks.interface\";\r\n\r\nexport class HooksCls {\r\n    private hooks: { [key in keyof Hooks]: HookItem[] } = {\r\n        afterInit: [],\r\n        onDestroy: [],\r\n        onViewChange: [],\r\n        onChangeDetection: [],\r\n        onPropsChange: []\r\n    };\r\n\r\n    public set(key: HookKeys, hook: HookItem) {\r\n        this.hooks[key].push(hook);\r\n    }\r\n\r\n    public run(key: HookKeys, args: any[] = []) {\r\n        this.hooks[key] = this.hooks[key].filter(hook => hook.isActive());\r\n        this.hooks[key].forEach(item => item.hook(...args));\r\n    }\r\n\r\n    public clear(key: HookKeys) {\r\n        this.hooks[key] = [];\r\n    }\r\n}","import { MonsterWebComponent } from \"../interfaces/monster-web-component.interface\";\r\n\r\nexport function defineComponent(component: MonsterWebComponent) {\r\n    customElements.define(component.selector, component);\r\n}\r\n","import { viewDir } from \"../directives/view.directive\";\r\nimport { ComponentInstance } from \"../interfaces/component-instance.interface\";\r\nimport { CustomObject } from \"../interfaces/custom-object.interface\";\r\nimport { DirectiveParam } from \"../interfaces/directive-param.interface\";\r\nimport { Watcher } from \"../interfaces/watcher.interface\";\r\nimport { FunctionComponent } from \"../interfaces/function-component.interface\";\r\nimport { setProps } from \"./set-props\";\r\nimport { HooksCls } from \"./hooks\";\r\nimport { HookKeys } from \"../enums/hook-keys.enum\";\r\nimport { detectChanges } from \"./detect-changes\";\r\nimport { defineComponent } from \"../utils/define-component\";\r\n\r\nexport function component(functionComponent: FunctionComponent, selector: string): CustomElementConstructor {\r\n\r\n    const superClass = functionComponent.superClass || HTMLElement;\r\n\r\n    return class extends superClass implements ComponentInstance {\r\n\r\n        public static selector = selector;\r\n\r\n\r\n        private fn = functionComponent;\r\n\r\n\r\n        /**\r\n         * State\r\n         */\r\n        state: CustomObject = {};\r\n        stateIndex: number = 0;\r\n\r\n\r\n        /**\r\n         * Directives\r\n         */\r\n        directives: CustomObject<(param: DirectiveParam) => void> = {\r\n            view: viewDir,\r\n            ...functionComponent.directives\r\n        };\r\n\r\n\r\n        /**\r\n         * Pipes\r\n         */\r\n        pipes = functionComponent.pipes || {};\r\n\r\n\r\n        /**\r\n         * Hooks\r\n         */\r\n        hooks: HooksCls = new HooksCls();\r\n\r\n\r\n        /**\r\n         * Props\r\n         */\r\n        props: CustomObject = {};\r\n        setProps = setProps.bind(this);\r\n\r\n\r\n        /**\r\n         * Change detection\r\n         */\r\n        public isCDRunning: boolean = false;\r\n        detectChanges = () => detectChanges(this);\r\n        watchers: Watcher[] = [];\r\n        conditionWatchers: Watcher[] = [];\r\n\r\n\r\n\r\n\r\n\r\n        connectedCallback() {\r\n\r\n            if (!this.fn.childrenDefined) {\r\n                (this.fn.children || []).forEach(child => defineComponent(child));\r\n            }\r\n            this.fn.childrenDefined = true;\r\n\r\n            const element = this.fn(this.props, this);\r\n            this.appendChild(element);\r\n\r\n\r\n            if (this.fn.styles) {\r\n                const styles = this.fn.styles;\r\n                this.fn.styles = null;\r\n                const styleEl = document.createElement('style');\r\n                styleEl.textContent = styles;\r\n                document.getElementsByTagName('head')[0].appendChild(styleEl);\r\n            }\r\n\r\n\r\n            /**\r\n             * Run onPropsChange hook during initialization if there are props present\r\n             */\r\n            if (Object.keys(this.props).length > 0) {\r\n                this.hooks.run(HookKeys.onPropsChange, [this.props]);\r\n            }\r\n\r\n\r\n            this.hooks.run(HookKeys.afterInit);\r\n            this.hooks.clear(HookKeys.afterInit);\r\n        }\r\n\r\n        disconnectedCallback() {\r\n            this.hooks.run(HookKeys.onDestroy);\r\n        }\r\n\r\n    }\r\n}","import { HookKeys } from \"../enums/hook-keys.enum\";\r\nimport { ComponentInstance } from \"../interfaces/component-instance.interface\";\r\nimport { evaluateWatchers } from \"./evaluate-watchers\";\r\n\r\n/**\r\n * This function is use to run change detection of the component.\r\n * The context is the component that change detection is running\r\n * \r\n * @returns void\r\n */\r\nexport function detectChanges(context: ComponentInstance) {\r\n    if (context.isCDRunning) {\r\n        return;\r\n    }\r\n    context.isCDRunning = true;\r\n\r\n    let hasViewChanges = evaluateWatchers(context);\r\n\r\n    context.hooks.run(HookKeys.onChangeDetection);\r\n    if (hasViewChanges) {\r\n        context.hooks.run(HookKeys.onViewChange);\r\n    }\r\n\r\n    context.isCDRunning = false;\r\n}\r\n","import { ComponentInstance } from \"../interfaces/component-instance.interface\";\r\n\r\nexport function evaluateWatchers(context: ComponentInstance): boolean {\r\n    let hasViewChanges = false;\r\n    [...context.conditionWatchers, ...context.watchers].forEach(watcher => {\r\n        if (watcher.isUpdated() && watcher.isConnected()) {\r\n            hasViewChanges = true;\r\n            watcher.update(watcher.val);\r\n        }\r\n    });\r\n\r\n    // cleanup watchers\r\n    context.conditionWatchers = context.conditionWatchers.filter(watcher => watcher.isConnected());\r\n    context.watchers = context.watchers.filter(watcher => watcher.isConnected());\r\n\r\n    return hasViewChanges;\r\n}","import { CustomObject } from \"../interfaces/custom-object.interface\";\r\n\r\nexport function createElement(tag: string, attributes: CustomObject = {}, children: (HTMLElement | Text)[] = []): HTMLElement {\r\n    const element = document.createElement(tag);\r\n\r\n    for (const [key, value] of Object.entries(attributes)) {\r\n        element.setAttribute(key, value);\r\n    }\r\n\r\n    element.append(...children);\r\n\r\n    return element;\r\n}","export function createText(text: string): Text {\r\n    return document.createTextNode(text);\r\n}","import { ComponentInstance } from \"../interfaces/component-instance.interface\";\r\nimport { CustomObject } from \"../interfaces/custom-object.interface\";\r\nimport { Watcher } from \"../interfaces/watcher.interface\";\r\n\r\nexport function attributeBinding(context: ComponentInstance, element: HTMLElement, attributes: CustomObject<() => any>) {\r\n\r\n    const watcher: Watcher = {\r\n        val: {},\r\n        isConnected: () => element.isConnected,\r\n        isUpdated: () => {\r\n            let isUpdated = false;\r\n\r\n            for (const [key, value] of Object.entries(attributes)) {\r\n                const newValue = value();\r\n                if (watcher.val[key] !== newValue) {\r\n                    isUpdated = true;\r\n                }\r\n                watcher.val[key] = newValue;\r\n            }\r\n\r\n            return isUpdated;\r\n        },\r\n        update: ((newValue: CustomObject) => {\r\n            for (const [key, value] of Object.entries(newValue)) {\r\n                element.setAttribute(key, value);\r\n            }\r\n        })\r\n    };\r\n\r\n    for (const [key, value] of Object.entries(attributes)) {\r\n        const currentValue = value();\r\n        watcher.val[key] = currentValue;\r\n        element.setAttribute(key, currentValue);\r\n    }\r\n\r\n    context.watchers.push(watcher);\r\n    return element;\r\n}\r\n","import { ComponentInstance } from \"../interfaces/component-instance.interface\";\r\nimport { Watcher } from \"../interfaces/watcher.interface\";\r\n\r\nexport function textBinding(context: ComponentInstance, valueCaller: () => any): Text {\r\n    const val = valueCaller();\r\n    const text = document.createTextNode(val);\r\n\r\n    const watcher: Watcher = {\r\n        val,\r\n        isConnected: () => text.isConnected,\r\n        isUpdated: () => {\r\n            const newValue = valueCaller();\r\n            if (watcher.val !== newValue) {\r\n                watcher.val = newValue;\r\n                return true;\r\n            }\r\n            return false;\r\n        },\r\n        update: (newValue: any) => text.textContent = newValue\r\n    };\r\n\r\n    context.watchers.push(watcher);\r\n\r\n    return text;\r\n}","import { ComponentInstance } from \"../interfaces/component-instance.interface\";\r\nimport { CustomObject } from \"../interfaces/custom-object.interface\";\r\nimport { Watcher } from \"../interfaces/watcher.interface\";\r\n\r\nexport function renderChild(\r\n    tag: string,\r\n    attributes: CustomObject,\r\n    children: (HTMLElement | Text)[],\r\n    context: ComponentInstance,\r\n    props: CustomObject<() => any>\r\n): HTMLElement {\r\n    const child = customElements.get(tag);\r\n    if (!child) {\r\n        console.error(`The component ${tag} is not defined.`);\r\n        return;\r\n    }\r\n    const element = new child();\r\n\r\n    if (Object.keys(props).length > 0) {\r\n        /**\r\n         * Add props watcher is there is a props\r\n         */\r\n        const watcher: Watcher = {\r\n            val: {},\r\n            isConnected: () => element.isConnected,\r\n            isUpdated: () => {\r\n                let hasChanges = false;\r\n                for (const [key, value] of Object.entries(props)) {\r\n                    const newValue = value();\r\n                    if (watcher.val[key] !== newValue) {\r\n                        hasChanges = true;\r\n                    }\r\n                    watcher.val[key] = newValue;\r\n                }\r\n                return hasChanges;\r\n            },\r\n            update: (newValue: CustomObject) => {\r\n                (element as unknown as ComponentInstance).setProps(newValue);\r\n            }\r\n        };\r\n        watcher.isUpdated();\r\n        watcher.update(watcher.val);\r\n        if (context.watchers && Array.isArray(context.watchers)) {\r\n            context.watchers.push(watcher);\r\n        }\r\n    }\r\n\r\n\r\n    for (const [key, value] of Object.entries(attributes)) {\r\n        element.setAttribute(key, value);\r\n    }\r\n    element.append(...children);\r\n    return element;\r\n}\r\n","import { CustomObject } from \"../interfaces/custom-object.interface\";\r\n\r\nexport class DevTool {\r\n    private static instance;\r\n\r\n    private devTool;\r\n\r\n    constructor() {\r\n        if (DevTool.instance) {\r\n            return DevTool.instance;\r\n        }\r\n\r\n        if ((window as any).__REDUX_DEVTOOLS_EXTENSION__) {\r\n            this.devTool = (window as any).__REDUX_DEVTOOLS_EXTENSION__.connect();\r\n        }\r\n\r\n        DevTool.instance = this;\r\n    }\r\n\r\n    subscribe(handler: (message?: any) => void) {\r\n        if (this.devTool) {\r\n            this.devTool.subscribe(handler);\r\n        }\r\n    }\r\n\r\n    init(state: CustomObject) {\r\n        if (this.devTool) {\r\n            this.devTool.init(state);\r\n        }\r\n    }\r\n\r\n    send(action: string, state: CustomObject) {\r\n        if (this.devTool) {\r\n            this.devTool.send(action, state);\r\n        }\r\n    }\r\n}","import { ComponentInstance } from \"../interfaces/component-instance.interface\";\r\nimport { DevTool } from \"../utils/dev-tool\";\r\n\r\ninterface ChangeDetection {\r\n    isConnected: () => boolean;\r\n    changeDetection: () => void;\r\n};\r\n\r\nlet state = {};\r\nlet changeDetections: ChangeDetection[] = [];\r\n\r\n\r\n/**\r\n * Devtool\r\n */\r\nconst devTool = new DevTool();\r\ndevTool.subscribe((message) => {\r\n    if (message.type === 'DISPATCH' && message.state) {\r\n        const newSate = JSON.parse(message.state);\r\n\r\n        for (const key in newSate) {\r\n            state[key] = newSate[key];\r\n        }\r\n\r\n        runChangeDetections();\r\n    }\r\n});\r\ndevTool.init(state);\r\n\r\n/**\r\n * Devtool [end]\r\n */\r\n\r\n\r\nexport function createSharedState<T>(name: string, value?: T) {\r\n    state[name] = value;\r\n    devTool.send(`Init : ${name}`, state);\r\n\r\n    return function(context: ComponentInstance): [() => T, (value: T) => void] {\r\n        changeDetections.push({\r\n            isConnected: () => (context as unknown as HTMLElement).isConnected,\r\n            changeDetection: () => context.detectChanges()\r\n        });\r\n\r\n        const getter = () => state[name];\r\n        const setter = (value: T) => {\r\n            if (value !== state[name]) {\r\n                state[name] = value;\r\n                runChangeDetections();\r\n\r\n                devTool.send(`SET : ${name}`, state);\r\n\r\n            }\r\n        }\r\n\r\n        return [getter, setter];\r\n    }\r\n}\r\n\r\nfunction runChangeDetections() {\r\n    changeDetections = changeDetections.filter(item => item.isConnected());\r\n    changeDetections.forEach(item => item.changeDetection());\r\n}","import { FunctionPipe } from \"../interfaces/function-pipe.interface\";\r\n\r\nexport function pipe(fnPipe: FunctionPipe, selector: string) {\r\n    fnPipe.selector = selector;\r\n    return fnPipe;\r\n}","import { pipe } from \"./pipe\";\r\n\r\nfunction lowercase(text: string) {\r\n    return text.toLowerCase();\r\n}\r\n\r\nexport const lowercasePipe = pipe(lowercase, 'lowercase');","import { pipe } from \"./pipe\";\r\n\r\nfunction uppercase(text: string, params: any[]) {\r\n    return text.toUpperCase();\r\n}\r\n\r\nexport const uppercasePipe = pipe(uppercase, 'uppercase');\r\n","import { component, defineComponent } from '@monster-js/core';\r\nimport { environment } from '../environments/environment';\r\n\r\nfunction child() {\r\n    return <h1>Child</h1>\r\n}\r\n\r\ndefineComponent(component(child, 'app-child'));\r\n\r\nfunction app() {\r\n    let id = 100;\r\n    return <div>\r\n        <h1 id={id}>Hello World!</h1>\r\n        {environment.title} xx\r\n        <app-child></app-child>\r\n    </div>\r\n}\r\n\r\nexport default component(app, 'app-root');\r\n","import { defineComponent } from '@monster-js/core';\r\nimport app from './app/app';\r\n\r\ndefineComponent(app);\r\n","export const environment = {\r\n    title: 'dev'\r\n};\r\n"],"names":["viewDir","params","directives","element","context","model","ref","modelGetter","modelSetter","get","value","addEventListener","event","target","detectChanges","set","HookKeys","setProps","props","key","Object","entries","this","hooks","run","isConnected","HooksCls","afterInit","onDestroy","onViewChange","onChangeDetection","onPropsChange","hook","push","args","filter","isActive","forEach","item","clear","defineComponent","component","customElements","define","selector","functionComponent","superClass","HTMLElement","fn","state","stateIndex","view","pipes","bind","isCDRunning","hasViewChanges","conditionWatchers","watchers","watcher","isUpdated","update","val","evaluateWatchers","connectedCallback","childrenDefined","children","child","appendChild","styles","styleEl","document","createElement","textContent","getElementsByTagName","keys","length","disconnectedCallback","tag","attributes","setAttribute","append","createText","text","createTextNode","attributeBinding","newValue","currentValue","textBinding","valueCaller","renderChild","console","error","hasChanges","Array","isArray","DevTool","constructor","instance","window","__REDUX_DEVTOOLS_EXTENSION__","devTool","connect","subscribe","handler","init","send","action","changeDetections","pipe","fnPipe","message","type","newSate","JSON","parse","changeDetection","toLowerCase","toUpperCase"],"sourceRoot":""}